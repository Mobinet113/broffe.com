jQuery(function(a){function b(b,c){for(var d=0;d<c.length;d++)a(b).find("#dlm_"+c[d]).addClass("dlm-checkout-field-error")}function c(b){a(b).find(".dlm-checkout-field-error").removeClass("dlm-checkout-field-error")}function d(b,c){var d=a("<div>").addClass("dlm-checkout-error");d.append(a("<img>").attr("src",dlm_strings.icon_error).attr("alt","Checkout error").addClass("dlm-checkout-error-icon")),d.append(a("<p>").html(c)),b.prepend(d)}function e(a){a.find(".dlm-checkout-error").remove()}function f(b){a(b).find("#dlm_checkout_submit").attr("disabled",!0);var c=a("<div>").addClass("dlm-checkout-overlay-bg"),d=a("<div>").addClass("dlm-checkout-overlay");d.append(a("<h2>").html(dlm_strings.overlay_title)),d.append(a("<span>").html(dlm_strings.overlay_body)),d.append(a("<img>").attr("src",dlm_strings.overlay_img_src)),a("body").append(c),a("body").append(d),c.fadeIn(300,function(){d.css("display","block").css("top","47%"),d.animate({top:"+=3%"},300)})}function g(b){var c=a(".dlm-checkout-overlay:first"),d=a(".dlm-checkout-overlay-bg:first");c.fadeOut(300,function(){c.remove()}),d.fadeOut(300,function(){d.remove(),a(b).find("#dlm_checkout_submit").attr("disabled",!1)})}a("#dlm-form-checkout").submit(function(h){var i=a(this);c(i),e(i),f(i);var j={first_name:i.find("#dlm_first_name").val(),last_name:i.find("#dlm_last_name").val(),company:i.find("#dlm_company").val(),email:i.find("#dlm_email").val(),address_1:i.find("#dlm_address_1").val(),postcode:i.find("#dlm_postcode").val(),city:i.find("#dlm_city").val(),country:i.find("#dlm_country").val()},k={payment_gateway:a("input[name=dlm_gateway]:checked",a(this)).val(),customer:j};void 0!==i.data("order_id")&&(k.order_id=i.data("order_id")),void 0!==i.data("order_hash")&&(k.order_hash=i.data("order_hash"));for(var l=[],m=!0,n=0;n<dlm_strings.required_fields.length;n++)""===j[dlm_strings.required_fields[n]]&&(m=!1,l.push(dlm_strings.required_fields[n]));return!1===m?(b(i,l),d(i,dlm_strings.error_message_required_fields),g(i),!1):(a.post(dlm_strings.ajax_url_place_order,k,function(a){if(!0===a.success&&void 0!==a.redirect)return window.location.replace(a.redirect),!1;!1===a.success&&""!==a.error&&d(i,a.error),g(i)}),!1)})});